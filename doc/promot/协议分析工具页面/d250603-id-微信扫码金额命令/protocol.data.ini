3-8)下载微信用水金额请求(预约水控机 微信扫码消费)
上位机:
静态ID(16字节高字节在前)+ 
设备机器号(4字节高字节在前)+ 
从设备机器号(4字节高字节在前,00000000表示主设备,非零表示中转设备)+ 
协议类型(2字节高字节在前,0000表示主设备协议,非零表示中转设备协议)+ 
设备类型(2字节高字节在前)+ 
数据长度(2字节高字节在前)+ 
DF+0D+ 
随机码(4字节高字节在前,可选)+ 
数据+ 
CRC校验(字节高字节在前),
数据=帖类型(1字节,00即实用水(ID卡用水,账号+ 
密码用水),01预约用水)+ 
帐号(4字节物理卡号高字节在前)+ 
卡号(4字节物理卡号高字节在前)+ 
卡类型(1字节,卡类型)+ 
模式(1字节)+ 
费率(4字节,时间模式分/秒,流量模式分/脉冲)+ 
卡计数器(两字节)+ 
大钱包余额(四字节)+ 
补助计数器(两字节)+ 
补助钱包余额(四字节)+ 
使用金额(4字节)+ 
水龙头索引(两字节,第一字节水龙头索引,第二字节水龙头索引补码)+ 
卡状态(0 正常卡 1挂失卡 2卡不存在)+ 
20字节学工号+ 
CRC校验(4字节的账号,4字节的卡号,2字节CRC校验(对账号进行校验),高字节在前)+ 
用水量(四字节)+ 
用水时间(四字节)+ 
用户编号(15字节,无用字节写0)+ 
用户密码(6字节)+ 
预约用水时间段(4字节的开始时间,4字节的结束时间)+ 
预约后失效时间(2字节)+ 
水温控制(2字节)+ 
时间戳(4字节)+ 
姓名(10字节,高字节在前),
下位机(设备)回复:
静态ID(16字节高字节在前)+ 
设备机器号(4字节高字节在前)+ 
从设备机器号(4字节高字节在前,00000000表示主设备,非零表示中转设备)+ 
协议类型(2字节高字节在前,0000表示主设备协议,非零表示中转设备协议)+ 
设备类型(2字节高字节在前)+ 
数据长度(2字节高字节在前)+
03DF0D01+
随机码(4字节高字节在前,可选)+ 
返回数据(9字节)+ 
CRC校验(2字节高字节在前),
返回数据(9字节):
第一字节:00设备空闲,01设备正在使用
第二字节:(4字节卡号高字节)
第三字节:(4字节卡号次高字节)
第四字节:(4字节卡号低字节)
第五字节:(4字节卡号次低字节) +
时间戳(4字节)

当返回的状态和卡号为:00 00 00 00 00 时,设备空闲
当返回的状态和卡号为:01 ff ff ff ff 时,数据满,无法消费
当返回的状态和卡号为:01 02 00 00 02 时,被卡号(33554434)正在使用该设备


000000000000000000000000000027110000271100000000000003030079DF0D00000000002173DC622173DC620000000000002FD100000064F9C5000000000000006400FF0000000DEF001E850B7A9D07000000000000000000000000000000000000003230323330373033313335373231330000000030390000000000000000000000002FD1F9C5323032333037303331337752

00000000000000000000000000002711000027110000000000000303001503df0d0100000000002173dc622fd1f9c5a25b
